import { asyncForEach } from "@/common/utils/asyncUtils"
import { getDbCollection } from "@/common/utils/mongodbUtils"

export const up = async () => {
  const map = {
    "Exploitation agricole": ["A1301", "A1405", "A1407", "A1410", "A1411", "A1416", "A1413", "A1409", "A1304", "A1420", "A1401", "A1419", "A1418"],
    "Elevage d'animaux de ferme": ["A1301", "A1403", "A1407", "A1408", "A1416", "A1409", "A1410", "A1411", "A1304", "A1419"],
    "Elevage de chevaux": ["A1407", "G1210"],
    "Horticulture : production de fleurs, vegetaux, arbustes": ["A1405", "A1414", "A1301", "A1402", "A1416", "A1304", "A1419"],
    "Production d'alcool (vin, biere, cidre…)": ["A1405", "A1413", "A1303", "A1304", "A1422", "A1418"],
    "Paysagisme, jardinage, entretien des espaces verts": ["A1203", "A1414", "A1301", "A1202", "A1204", "A1213", "A1208", "I1506", "A1211"],
    "Conseil, vente de produits bancaires ou d'assurance, gestion de clientele": [
      "C1203",
      "C1206",
      "C1102",
      "C1109",
      "C1110",
      "C1201",
      "C1205",
      "C1401",
      "C1104",
      "C1207",
      "C1103",
      "C1202",
      "C1101",
      "D1409",
      "D1410",
      "C1208",
    ],
    "Facade, etancheite, acoustique, isolation, couverture": ["F1613", "F1610", "F1611", "I1501", "F1113", "F1114", "F1110", "F1619"],
    "Conduite de travaux, direction de chantier": ["F1201", "F1202", "I1101", "A1213", "F1206", "F1205", "A1211"],
    "Ingenierie en BTP (Bureau d'etudes, conception technique, BIM, …)": ["F1106", "F1104", "I1101", "F1111", "F1110", "F1112", "F1122"],
    Architecture: ["F1104", "F1101", "F1202", "F1109", "F1112"],
    "Travail du bois, ebenisterie, Menuiserie, Charpente": [
      "F1604",
      "F1503",
      "F1607",
      "F1501",
      "F1502",
      "H2201",
      "H2202",
      "H2205",
      "H2206",
      "H2207",
      "H2208",
      "H2209",
      "H2203",
      "H2204",
      "F1614",
      "F1616",
    ],
    Coiffure: ["D1202", "L1501", "D1216"],
    "Developpement commercial, force de vente": ["D1403", "D1402", "D1404", "D1406", "D1409", "D1410", "D1420", "D1415", "D1416", "D1510", "M1823", "M1715", "E1113", "D1417"],
    "Management commercial": ["D1406", "D1407", "D1509", "D1502", "D1503", "D1402", "D1301", "D1504", "D1403", "D1508", "D1409", "D1410", "M1715", "D1417"],
    "Commerce en entreprise": ["D1401", "D1409", "D1410", "D1416", "D1417"],
    "Metiers du droit": ["K1901", "K1902", "K1903", "K1904", "K1505", "M1612"],
    "Finance, Analyse financiere, controle de gestion, tresorerie": ["M1205", "M1201", "M1204", "M1207", "M1206", "C1301", "K1504", "M1208", "M1611", "M1612", "M1209"],
    "Enseignement, Recherche": ["K2401", "K2402", "M1403", "H1221"],
    Formation: ["K2101", "K2102", "K2111", "K2110", "K2114", "M1504", "M1505"],
    "Ressources humaines": ["M1502", "M1503", "M1501", "M1402", "M1413", "M1209"],
    "Administratif, secretariat, assistanat": ["M1701", "M1605", "M1608", "M1607", "M1601", "M1602", "M1606", "M1604", "M1613"],
    "Management, direction d'hotel, restaurant, loisirs": ["G1402", "G1403", "G1802", "G1401", "G1404", "K1802", "G1810", "G1409", "G1411", "G1805"],
    Energie: [
      "H1302",
      "H1206",
      "H2502",
      "H1102",
      "I1102",
      "H1502",
      "H1504",
      "H1209",
      "H1402",
      "F1203",
      "I1302",
      "I1304",
      "F1401",
      "F1402",
      "H2701",
      "H1225",
      "H2508",
      "H1309",
      "H1306",
    ],
    "Genie industriel, ingenierie generaliste": [
      "H1102",
      "H1206",
      "H2502",
      "F1203",
      "H1302",
      "H1402",
      "H1502",
      "I1102",
      "H1404",
      "H1401",
      "H1203",
      "H2901",
      "H2909",
      "I1302",
      "I1304",
      "I1313",
    ],
    "Ingenierie d'affaires en industrie": ["H1102", "H1403", "H1404", "H1206", "H1402", "H1401", "H1502", "H2502", "H1203", "H1103"],
    "Conception de jeux videos": ["L1302", "L1304", "M1805", "M1827", "M1841", "M1856", "M1836"],
    "Developpement web, integration": [
      "M1805",
      "M1806",
      "M1802",
      "M1827",
      "M1812",
      "M1855",
      "M1841",
      "M1846",
      "M1860",
      "M1813",
      "M1818",
      "M1842",
      "M1856",
      "M1844",
      "M1821",
      "M1861",
      "M1836",
    ],
    "Mecanique, carrosserie auto, moto": ["I1604", "I1606", "I1607", "H3404", "H1203", "I1613", "I1609", "I1617", "I1612", "I1619"],
    "Mecanique engins agricoles et engins de chantier": ["I1603", "I1103", "I1607", "I1304", "I1613", "I1616", "I1618"],
    "Mecanique, maintenance industrielle": [
      "I1310",
      "I1304",
      "H1404",
      "I1302",
      "H2504",
      "H1206",
      "H1402",
      "H2502",
      "I1102",
      "H1203",
      "H2901",
      "H2909",
      "I1301",
      "I1303",
      "I1502",
      "I1620",
      "I1313",
    ],
    "Administration publique (impots, hopitaux, prisons, structures sociales, …)": [
      "K1401",
      "K1402",
      "K1403",
      "K1405",
      "K1501",
      "K1503",
      "M1301",
      "K1404",
      "K1502",
      "K1504",
      "H1105",
      "K1408",
      "K1409",
      "J1509",
      "J1510",
    ],
    "Sante, soins aux personnes": [
      "J1301",
      "J1502",
      "J1506",
      "J1501",
      "K2601",
      "K2603",
      "J1102",
      "J1104",
      "J1503",
      "J1504",
      "J1505",
      "J1507",
      "K1306",
      "J1101",
      "H1105",
      "J1103",
      "J1508",
      "K1409",
      "J1509",
      "J1510",
    ],
    "Kinesitherapie, reeducation": ["J1403", "J1404", "J1406", "J1412", "G1215"],
    "Securite, secours, surveillance": ["K1704", "K1705", "K1706", "K2502", "K2503", "K2501", "K1702", "K1703", "K1707", "M1807"],
    "Metiers du sport": ["G1204", "L1401", "H1206", "G1209", "G1217", "G1213", "G1210", "G1215"],
    "Transport aerien": ["N2102", "N2203", "N2204", "N2205", "N2202", "N1201", "N1202", "M1616", "N2101"],
    "Magasinage, manutention, entreposage, preparation de commandes": ["N1103", "N1301", "N1303", "N1104", "N1105", "H3302", "N4120", "N1113", "N1110", "N1115", "F1710"],
    "Management, exploitation, gestion, ingenierie de la chaine logistique": [
      "N1303",
      "N1301",
      "N1302",
      "N3201",
      "N3202",
      "N4201",
      "N4202",
      "N1202",
      "N1201",
      "N4203",
      "N4204",
      "H1401",
      "H1405",
      "H1406",
      "N1305",
    ],
  }

  await asyncForEach(Object.entries(map), ([sousDomaine, codesRomes]) =>
    getDbCollection("domainesmetiers").updateOne({ sous_domaine_sans_accent_computed: sousDomaine }, { $set: { codes_romes: codesRomes } })
  )
}

/*
    

*/

// set to false ONLY IF migration does not imply a breaking change (ex: update field value or add index)
export const requireShutdown: boolean = false
