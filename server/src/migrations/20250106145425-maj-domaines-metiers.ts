import { asyncForEach } from "@/common/utils/asyncUtils"
import { getDbCollection } from "@/common/utils/mongodbUtils"

export const up = async () => {
  const map = {
    "Exploitation agricole": ["A1301", "A1405", "A1407", "A1410", "A1411", "A1416", "A1413", "A1409", "A1304", "A1420"],
    "Exploitation forestiere, sylviculture": ["A1201", "A1205", "A1101", "A1204", "A1301", "A1405", "A1303", "A1304", "A1213"],
    "Elevage d'animaux de ferme ": ["A1301", "A1403", "A1407", "A1408", "A1416", "A1409", "A1410", "A1411", "A1304"],
    "Elevage de chats, chiens": ["A1408"],
    "Elevage de chevaux": ["A1407"],
    "Soins aux animaux": ["A1501", "A1502", "A1407", "A1503", "A1504"],
    "Horticulture : production de fleurs, vegetaux, arbustes": ["A1405", "A1414", "A1301", "A1402", "A1416", "A1304"],
    "Production d'alcool (vin, biere, cidre…)": ["A1405", "A1413", "A1303", "A1304", "A1422"],
    "Production de produits fermiers": ["A1412", "A1301", "A1403", "A1304"],
    "Conduite d'engins agricoles": ["A1101", "A1205", "A1405"],
    "Paysagisme, jardinage, entretien des espaces verts": ["A1203", "A1414", "A1301", "A1202", "A1204", "A1213", "A1208", "I1506"],
    "Ingenierie, agronomie": ["A1303", "A1301", "A1302", "A1416", "A1405", "A1407", "A1204", "A1205", "A1304"],
    "Elevage de poissons, produits de la mer": ["A1404", "A1301", "A1406", "A1415", "A1417", "A1403", "A1430"],
    "Boucherie, charcuterie, traiteur": ["D1103", "D1101", "H2101", "H2103"],
    Poissonnerie: ["D1105"],
    "Boulangerie, patisserie, chocolaterie": ["D1102", "D1104", "G1610"],
    "Animation jeunesse, culturelle, touristique": ["G1202", "G1201", "G1203", "K1802", "K1206", "K1307"],
    "Dessin d'art": ["B1101"],
    Photographie: ["E1201", "E1104", "E1203", "E1202"],
    "Mobilier, ameublement, tapisserie": ["B1804", "B1806"],
    "Fabrication et reparation d'instruments de musique": ["B1501"],
    "Taxidermie, naturalisme": ["B1701"],
    "Sculpture, gravure, travail des matieres (pierre, verre, plastique, ceramique,bois …)": ["B1101", "B1303", "B1601", "B1402", "B1302", "B1602", "B1201", "B1401"],
    "Bijouterie, Joaillerie, Horlogerie, Gemmologie": ["B1603", "B1604", "H3401"],
    Actuariat: ["C1105"],
    "Management, support en banque, assurance": [
      "C1104",
      "C1106",
      "C1107",
      "C1108",
      "C1205",
      "C1204",
      "C1302",
      "C1202",
      "C1203",
      "C1207",
      "C1109",
      "C1303",
      "C1401",
      "C1206",
      "C1101",
    ],
    "Conseil, vente de produits bancaires ou d'assurance, gestion de clientele": [
      "C1203",
      "C1206",
      "C1102",
      "C1109",
      "C1110",
      "C1201",
      "C1205",
      "C1401",
      "C1104",
      "C1207",
      "C1103",
      "C1202",
      "C1101",
      "D1409",
      "D1410",
    ],
    "Geologie, hydrologie, topographie": ["F1108", "F1107", "F1105", "M1808"],
    "Facade, etancheite, acoustique, isolation, couverture": ["F1613", "F1610", "F1611", "I1501", "F1113", "F1114", "F1110"],
    Plomberie: ["F1603", "I1308"],
    "Carrelage, mosaique, parquet, solerie": ["F1608", "F1609"],
    "Conduite de travaux, direction de chantier": ["F1201", "F1202", "I1101", "A1213", "F1206", "F1205"],
    "Ingenierie en BTP (Bureau d'etudes, conception technique, BIM, …)": ["F1106", "F1104", "I1101", "F1111", "F1110"],
    Architecture: ["F1104", "F1101", "F1202", "F1109"],
    "Platrerie, pose de plaques": ["F1604", "F1601", "F1110", "F1615"],
    "Maconnerie, coffrage": ["F1701", "F1703", "F1702", "F1705", "F1706"],
    "Taille et decoration de pierre": ["F1612"],
    "Peinture en batiment, decor mural, finitions": ["F1606", "F1615", "F1625"],
    "Travail du bois, ebenisterie, Menuiserie, Charpente": [
      "F1604",
      "F1503",
      "F1607",
      "F1501",
      "F1502",
      "H2201",
      "H2202",
      "H2205",
      "H2206",
      "H2207",
      "H2208",
      "H2209",
      "H2203",
      "H2204",
    ],
    "Conduite d'engins de chantier": ["F1302", "N1101", "F1301", "F1704"],
    "Electricite, climatisation, domotique, electronique": [
      "F1106",
      "F1602",
      "F1605",
      "I1305",
      "I1309",
      "I1306",
      "I1308",
      "F1201",
      "H1202",
      "H2602",
      "H1502",
      "H2501",
      "H1206",
      "I1102",
      "H2601",
      "F1620",
      "F1117",
      "I1316",
    ],
    "Entretien et maintenance de batiments": ["I1203", "F1704"],
    "Diagnostic immobilier, conformite": ["F1204", "F1103", "F1113", "F1114"],
    "Cinema, Television, spectacle": ["L1201", "L1103"],
    "Techniques du son et de l'image": ["L1509", "L1505", "L1508", "L1507", "L1504"],
    "Comedie, theatre": ["L1203", "L1204"],
    "Musique, chant": ["L1202"],
    "Decor et accessoires pour le spectacle": ["L1503", "L1502", "L1506", "F1625"],
    "Production, realisation de films": ["L1302", "L1304", "L1510", "L1301", "E1204", "L1303"],
    Coiffure: ["D1202", "L1501"],
    Esthetique: ["D1208", "D1203"],
    "Decoration d'espaces, merchandising, architecture d'interieur": ["B1301", "D1506", "F1102", "L1503", "F1625"],
    "Developpement commercial, force de vente": ["D1403", "D1402", "D1404", "D1406", "D1409", "D1410", "D1420", "D1415", "D1416", "D1510", "M1823"],
    "Management commercial": ["D1406", "D1407", "D1509", "D1502", "D1503", "D1402", "D1301", "D1504", "D1403", "D1508", "D1409", "D1410"],
    "Vente en magasin : produits non alimentaires (vetements, equipement, livres, …)": [
      "D1211",
      "D1212",
      "D1214",
      "D1210",
      "D1503",
      "D1408",
      "D1501",
      "D1403",
      "D1507",
      "D1402",
      "D1106",
      "D1201",
      "D1204",
      "D1213",
      "N1110",
    ],
    "Teleconseil, vente a distance": ["D1408"],
    "Accueil, service client": ["D1408", "D1106", "D1107", "G1303", "G1703", "M1601", "M1401", "M1404", "K2602", "D1415", "M1616"],
    "Vente en magasin : alimentation, produits frais, boissons": ["D1301", "D1106", "D1401", "D1502", "D1505", "D1507", "D1107", "N1110", "D1510"],
    "Vente de fleurs, vegetaux": ["D1209"],
    "Pressing, blanchisserie, teinturerie, cordonnerie": ["D1205", "D1206", "K2201"],
    "Commerce en entreprise": ["D1401", "D1409", "D1410", "D1416"],
    "Gestion de l'information et de la documentation": ["K1601", "M1806", "K1602"],
    Edition: ["E1105", "D1201"],
    "Traduction, ecriture": ["E1103", "E1106", "E1108", "E1102"],
    "Communication, marketing, publicite": ["E1103", "E1104", "E1401", "E1105", "E1402", "E1205", "M1703", "M1707", "M1705", "M1704", "M1706", "M1702", "E1112", "M1716", "E1109"],
    "Journalisme, creation de contenu": ["E1106", "E1103", "E1104", "E1109"],
    "Organisation d'evenements": ["E1107", "E1103", "E1402", "E1104", "E1401", "L1303"],
    "Graphisme, infographisme, conception de contenus multimedia": ["E1205", "E1305", "E1306", "E1104", "E1103", "H1204", "E1206"],
    "Animation web, community management": ["E1101", "E1205", "E1103", "M1716", "E1110", "E1109"],
    "Comptabilite, gestion de paie": ["M1206", "M1203", "M1202", "M1507"],
    "Metiers du droit": ["K1901", "K1902", "K1903", "K1904", "K1505"],
    "Installation et maintenance reseaux telecom et energie": ["I1307", "F1113", "M1816", "F1623", "I1312"],
    "Assainissement biologique, nucleaire, depollution": ["I1503", "H1303", "K2305", "F1116", "H1225", "H2508", "I1505"],
    "Recyclage, collecte, traitement des dechets, assainissement, depollution": ["K2302", "K2303", "K2304", "K2305"],
    "Finance, Analyse financiere, controle de gestion, tresorerie": ["M1205", "M1201", "M1204", "M1207", "M1206", "C1301", "K1504", "M1208"],
    "Management, direction d'etablissement scolaire, d'enseignement": ["K2103"],
    "Enseignement, Recherche": ["K2401", "K2402", "M1403"],
    Education: ["K2104", "K2105", "K2106", "K2107", "K2108", "K2109", "K2110"],
    Formation: ["K2101", "K2102", "K2111", "K2110", "K2114"],
    "Direction d'entreprise": ["M1302", "M1301", "M1402", "M1413"],
    "Ressources humaines": ["M1502", "M1503", "M1501", "M1402", "M1413"],
    "Administratif, secretariat, assistanat": ["M1701", "M1605", "M1608", "M1607", "M1601", "M1602", "M1606", "M1604"],
    "Service en hotellerie, restauration": ["G1803", "G1801", "G1810"],
    "Management, direction d'hotel, restaurant, loisirs": ["G1402", "G1403", "G1802", "G1401", "G1404", "K1802", "G1810"],
    Sommellerie: ["G1804"],
    Cuisine: ["G1603", "G1402", "G1602", "G1604", "G1601", "G1401", "G1606", "G1609", "G1810"],
    Hotellerie: ["G1402", "G1603", "G1703", "G1501", "G1502", "G1503", "G1701"],
    "Vente, transaction, gestion immobiliere": ["C1504", "C1501", "C1502", "C1503"],
    "Conception de programmes immobiliers": ["C1503", "C1504"],
    Chimie: ["H1201", "H1505", "H2301", "H2504", "H2701", "H1503", "H1501", "H1206", "H2502", "I1102", "H1402", "H1102", "H1502", "H1506", "H1404"],
    "Plasturgie et materiaux composites": ["H3201", "H3202", "H3203", "H2504", "H1206", "H1402", "H2502", "H1502", "H2802", "H2803", "H2804", "H2805", "H3402", "H3403", "H3303"],
    "Metallurgie (soudure, chaudronnerie, tuyautage, …)": [
      "H2907",
      "H2908",
      "H2503",
      "H2903",
      "H2910",
      "H2912",
      "H2902",
      "H2904",
      "H2913",
      "H2914",
      "H2905",
      "H2901",
      "H1203",
      "H2909",
      "H2911",
    ],
    "Risques, qualite, hygiene, securite, environnement (QHSE)": [
      "H1404",
      "H1506",
      "H1504",
      "H1302",
      "H1502",
      "H1303",
      "H1402",
      "H1403",
      "H1206",
      "H1501",
      "H1401",
      "F1204",
      "H1301",
      "H1308",
      "H1304",
      "H1518",
    ],
    Energie: ["H1302", "H1206", "H2502", "H1102", "I1102", "H1502", "H1504", "H1209", "H1402", "F1203", "I1302", "I1304", "F1401", "F1402", "H2701", "H1225", "H2508"],
    "Industrie Textile": ["H2502", "H1402", "H2403", "H2404", "H2405", "H2406", "H2408", "H2409", "H2410", "H2411", "H2412", "H2413", "H2414", "H2415"],
    "Genie electrique": ["H1209", "H1504", "H1102", "H1206", "I1102", "H1502", "H2502"],
    "Robotique, systemes automatises": ["H1208", "I1301", "I1302", "H1206", "H2502", "I1102", "I1304", "I1305", "H1203", "H1209", "H1404", "H1506", "H2504", "H1401", "H2901"],
    "Biologie, sante, sciences physiques": [
      "H1206",
      "H1401",
      "H1402",
      "H1502",
      "H2502",
      "H1303",
      "H2504",
      "H1501",
      "H1404",
      "I1304",
      "H1302",
      "I1102",
      "I1305",
      "H1207",
      "H1210",
      "H1224",
    ],
    "Industrie du papier, carton, emballage": ["H1206", "H1502", "H2502", "H1203", "H1403", "H1404", "H1402", "H1204", "H3102", "H3101", "E1304"],
    "Genie industriel, ingenierie generaliste": [
      "H1102",
      "H1206",
      "H2502",
      "F1203",
      "H1302",
      "H1402",
      "H1502",
      "I1102",
      "H1404",
      "H1401",
      "H1203",
      "H2901",
      "H2909",
      "I1302",
      "I1304",
    ],
    "Ingenierie d'affaires en industrie": ["H1102", "H1403", "H1404", "H1206", "H1402", "H1401", "H1502", "H2502", "H1203"],
    "Design industriel": ["H1203", "H1204"],
    "Industrie Agroalimentaire": ["H2102", "H1505", "H2701", "H2906", "H3301", "H3302", "H3303", "H1206", "H1502", "H1506", "H1302", "H2502", "H1401", "H1402", "H2103", "H2104"],
    Imprimerie: ["E1302", "E1301", "E1105", "E1306", "H1502", "E1303", "E1307", "E1308", "E1304"],
    "Electronique, informatique industrielle": [
      "H1206",
      "H1402",
      "H2502",
      "I1102",
      "H1208",
      "H1502",
      "H1209",
      "H1504",
      "I1305",
      "I1304",
      "I1302",
      "H2501",
      "H2603",
      "H2604",
      "H2605",
    ],
    Aeronautique: ["I1304", "I1602", "I1305", "H2602", "I1302", "H2901", "H2909", "H1502", "H1206", "I1102"],
    "Conception de jeux videos": ["L1302", "L1304", "M1805", "M1827", "M1841", "M1856"],
    "Gestion de projets informatiques": ["M1803", "M1806", "M1828", "M1858", "M1814"],
    "Analyse de donnees, data": ["M1805", "M1403", "M1806", "M1802", "M1809", "M1405", "M1846"],
    "Developpement web, integration": ["M1805", "M1806", "M1802", "M1827", "M1812", "M1855", "M1841", "M1846", "M1860", "M1813", "M1818", "M1842", "M1856"],
    "Administration de systemes et reseaux informatiques et telecom": [
      "M1801",
      "M1802",
      "M1806",
      "M1810",
      "M1804",
      "H1101",
      "M1827",
      "M1812",
      "M1816",
      "M1841",
      "M1846",
      "M1860",
      "M1818",
      "M1822",
      "M1830",
      "M1835",
      "M1856",
    ],
    "Maintenance, installation et assistance informatique": ["I1401", "I1402", "I1320", "I1404", "I1403"],
    Achats: ["M1101", "M1102"],
    "Mecanique bateaux": ["I1605", "I1606", "H1203", "I1601"],
    "Mecanique, carrosserie auto, moto": ["I1604", "I1606", "I1607", "H3404", "H1203", "I1613"],
    "Mecanique engins agricoles et engins de chantier": ["I1603", "I1103", "I1607", "I1304", "I1613", "I1616"],
    "Mecanique, maintenance industrielle": ["I1310", "I1304", "H1404", "I1302", "H2504", "H1206", "H1402", "H2502", "I1102", "H1203", "H2901", "H2909", "I1301", "I1303", "I1502"],
    "Mode, travail du textile et du cuir": ["B1803", "B1805", "B1802", "B1801", "B1804", "H1205", "H2401", "H2402", "D1207", "H2409", "H2410", "H2411", "H2412", "H2413", "H2414"],
    "Management, direction en proprete, environnement": ["K2302", "K2306"],
    "Assainissement, distribution des eaux": ["K2301", "K2306", "K2305"],
    "Analyse medicale et biologique": ["J1302", "J1306", "J1201", "H1224"],
    Optique: ["J1405", "J1407"],
    Pharmacie: ["J1307", "J1202", "D1405"],
    "Administration publique (impots, hopitaux, prisons, structures sociales, …)": [
      "K1401",
      "K1402",
      "K1403",
      "K1405",
      "K1501",
      "K1503",
      "M1301",
      "K1404",
      "K1502",
      "K1504",
      "H1105",
      "K1408",
    ],
    "Sante, soins aux personnes": [
      "J1301",
      "J1502",
      "J1506",
      "J1501",
      "K2601",
      "K2603",
      "J1102",
      "J1104",
      "J1503",
      "J1504",
      "J1505",
      "J1507",
      "K1306",
      "J1101",
      "H1105",
      "J1103",
      "J1508",
    ],
    Dietetique: ["J1402"],
    Psychologie: ["K1103", "K1104"],
    "Kinesitherapie, reeducation": ["J1403", "J1404", "J1406", "J1412"],
    "Protheses, equipements medicaux ": ["J1410", "J1411", "J1401", "J1409"],
    "Secretariat medical": ["J1303", "M1609", "M1607"],
    "Conduite d'ambulance": ["J1305"],
    "Securite, secours, surveillance": ["K1704", "K1705", "K1706", "K2502", "K2503", "K2501", "K1702", "K1703", "K1707"],
    "Conseil en emploi, insertion, orientation": ["K1801", "K2112", "K1203"],
    "Education specialisee, assistance aupres d'enfants, puericulture": ["K1303", "J1304", "K1202", "K1308", "K1310", "K1307", "K2113"],
    "Education specialisee, assistance aupres d'adultes": ["K1301", "K1302", "K1305", "K1205", "K1204", "K1206", "K1207", "K1201", "K1101", "K1102", "K1306", "K1311"],
    "Nettoyage, proprete": ["K1304", "K2203", "K2204", "I1201", "I1501", "K2205", "I1506"],
    "Metiers du sport": ["G1204", "L1401", "H1206", "G1209"],
    "Tourisme : conception de produits touristiques, voyages": ["G1301", "G1302", "K1802"],
    "Transport ferroviaire": ["N4301", "N4401", "N4403"],
    "Transport aerien": ["N2102", "N2203", "N2204", "N2205", "N2202", "N1201", "N1202", "M1616"],
    "Magasinage, manutention, entreposage, peparation de commandes": ["N1103", "N1301", "N1303", "N1104", "N1105", "H3302", "N4120", "N1113", "N1110"],
    "Management, exploitation, gestion, ingenierie de la chaine logistique": [
      "N1303",
      "N1301",
      "N1302",
      "N3201",
      "N3202",
      "N4201",
      "N4202",
      "N1202",
      "N1201",
      "N4203",
      "N4204",
      "H1401",
    ],
    "Transport fluvial et maritime": ["N3201", "N3103", "N3101", "N3102", "I1601", "I1502"],
    Douane: ["N1202", "K1505"],
    "Transport, conduite, livraison": ["N4101", "N1102", "N4402", "N4103", "M1603", "N4104", "N4120", "N4109"],
    "Accueil touristique": ["N2201", "N4402", "N4103", "G1101", "G1102", "G1205", "G1206", "D1204", "M1616"],
  }

  await asyncForEach(Object.entries(map), ([sousDomaine, codesRomes]) =>
    getDbCollection("domainesmetiers").updateOne({ sous_domaine_sans_accent_computed: sousDomaine }, { $set: { codes_romes: codesRomes } })
  )

  await getDbCollection("domainesmetiers").updateOne(
    {
      sous_domaine_sans_accent_computed: "Magasinage, manutention, entreposage, peparation de commandes",
    },
    {
      $set: {
        sous_domaine_sans_accent_computed: "Magasinage, manutention, entreposage, preparation de commandes",
        sous_domaine: "Magasinage, manutention, entreposage, préparation de commandes",
      },
    }
  )

  await getDbCollection("domainesmetiers").updateOne(
    {
      sous_domaine_sans_accent_computed: "Protheses, equipements medicaux ",
    },
    { $set: { sous_domaine_sans_accent_computed: "Protheses, equipements medicaux", sous_domaine: "Prothèses, équipements médicaux" } }
  )

  await getDbCollection("domainesmetiers").updateOne(
    {
      sous_domaine_sans_accent_computed: "Elevage d'animaux de ferme ",
    },
    { $set: { sous_domaine_sans_accent_computed: "Elevage d'animaux de ferme", sous_domaine: "Elevage d'animaux de ferme" } }
  )
}
